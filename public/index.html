<!doctype html>
<html ng-app='images'>
    <head>
        <title>Images4</title>
        <link rel="stylesheet" type="text/css" href="css/index.css"/>
        <!--<link rel="stylesheet" type="text/css" href="css/jquery-ui.min.css"/>-->
        <!--<link rel="stylesheet" type="text/css" href="css/jquery.mobile.min.css"/>-->
        <script src="js/jquery.min.js"></script>
        <!--<script src="js/jquery.mobile.min.js"></script>-->
        <!--<script src="js/jquery-ui.min.js"></script>-->
        <script src="js/angular.min.js"></script>
        <!--<script src="js/ui-bootstrap-tpls.min.js"></script>-->
        <script src="js/angular-hotkeys.min.js"></script>
        <script src="js/angular-touch.min.js"></script>
        <script src="js/images.js"></script>
    </head>
    <body>
        <div ng-controller="Entry" ng-init="current = -1">
            <div class="title">
                <button ng-click="set_mode('query')" />Query</button>
                <button ng-click="set_mode('tags')" />Tags</button>
                <button ng-click="set_mode('metadata')" />Metadata</button>
                <button ng-click="set_mode('physical')" />Physical</button>
                {{me.id}} / {{me.name}} :: {{feed.offset + current + 1}} of {{feed.total_count}} :: {{message}}
            </div>
            <div class="query" ng-show="query_mode()">
                <div class="query_part">
                    After 
                    <input
                        type="text"
                        ng-model="q_start_ts"
                        ng-blur="enable_hk()"
                        ng-focus="disable_hk()"/>
                </div>
                <div class="query_part">
                    Before 
                    <input
                        type="text"
                        ng-model="q_end_ts"
                        ng-blur="enable_hk()"
                        ng-focus="disable_hk()"/>
                </div>
                <div class="query_part">
                    Format like <i>YYYY-MM-DD</i>.
                </div>
                <div class="query_part">
                    Have these tags
                    <div class="tag for_query  tag_{{list_have(tag.id, q_include_tags)}}"
                         style="background-color: {{tag.background_color}}; color: {{tag.foreground_color}};"
                         ng-repeat="tag in tag_feed.entries" 
                         ng-click="list_toggle(tag.id, q_include_tags)">
                        {{tag.id}}
                    </div>
                </div>
                <div class="query_part">
                    Don not have these tags
                    <div class="tag for_query tag_{{list_have(tag.id, q_exclude_tags)}}"
                         style="background-color: {{tag.background_color}}; color: {{tag.foreground_color}};"
                         ng-repeat="tag in tag_feed.entries" 
                         ng-click="list_toggle(tag.id, q_exclude_tags)">
                        {{tag.id}}
                    </div>
                </div>
                <div class="query_part">
                    <input
                        type="checkbox"
                        ng-model="q_image"
                        ng-true-value="'yes'"
                        ng-false-value="'no'"/>Image entries
                </div>
                <div class="query_part">
                    <input
                        type="checkbox"
                        ng-model="q_video"
                        ng-true-value="'yes'"
                        ng-false-value="'no'"/>Video entries
                </div>
                <div class="query_part">
                    <input
                        type="checkbox"
                        ng-model="q_audio"
                        ng-true-value="'yes'"
                        ng-false-value="'no'"/>Audio entries
                </div>
                <div class="query_part">
                    <input
                        type="checkbox"
                        ng-model="q_other"
                        ng-true-value="'yes'"
                        ng-false-value="'no'"/>Other entries
                </div>
                <div class="query_part">
                    <input
                        type="checkbox"
                        ng-model="q_show_hidden"
                        ng-true-value="'yes'"
                        ng-false-value="'no'"/>Show hidden entries
                </div>
                <div class="query_part">
                    <input
                        type="checkbox"
                        ng-model="q_only_hidden"
                        ng-true-value="'yes'"
                        ng-false-value="'no'"/>Show only hidden entries
                </div>
                <div class="query_part">
                    <input
                        type="checkbox"
                        ng-model="q_show_deleted"
                        ng-true-value="'yes'"
                        ng-false-value="'no'"/>Show deleted entries
                </div>
                <div class="query_part">
                    <input
                        type="checkbox"
                        ng-model="q_only_deleted"
                        ng-true-value="'yes'"
                        ng-false-value="'no'"/>Show only deleted entries
                </div>
                <div class="query_part" style="text-align: right;">
                    Press <i>Enter</i> to <button ng-click="reload()" />Update results</button>
                </div>
            </div>
            <div class="tags" ng-show="tags_mode()">
                <div class="tag tag_{{have_tag(tag.id)}}"
                     style="background-color: {{tag.background_color}}; color: {{tag.foreground_color}};"
                     ng-repeat="tag in tag_feed.entries" 
                     ng-click="toggle_tag(tag.id)">
                    {{tag.id}}
                </div>
                <input
                    style="width: 100%"
                    ng-model="new_tag_id"
                    ng-keypress="add_tag($event)"
                    ng-blur="enable_hk()"
                    ng-focus="disable_hk()"/>
            </div>
            <div class="metadata" ng-show="metadata_mode()">
                <i>No metadata</i>
            </div>
            <div class="metadata" ng-show="debug_mode()">
                <h3>Feed data</h3>
                <b>Offset</b>: {{feed.offset}}<br/>
                <b>Current</b>: {{current}}<br/>
                <b>Total Count</b>: {{feed.total_count}}<br/>
                <b>Page Count</b>: {{feed.count}}<br/>
                <b>Prev link</b>: {{feed.prev_link}}<br/>
                <b>Next link</b>: {{feed.next_link}}<br/>
            </div>
            <div class="metadata" ng-show="physical_mode()">
                <div class="warning" ng-show="current_is_deleted()">This entry will be deleted</div>
                <div class="info" ng-show="current_is_hidden()">This entry is hidden</div>
                <table>
                    <tr ng-repeat="(key, value) in get_current().physical_metadata">
                        <td>{{key}}</td><td>{{value}}</td>
                    </tr>
                </table>
            </div>
            <div
                id="proxy_holder"
                ng-swipe-left="next()"
                ng-swipe-right="previous()">
                <center>
                    <img
                        class="proxy"
                        ng-src="{{get_current_proxy_url()}}"/>
                </center>
            </div>
            <div id="entry_holder">
                <table>
                    <tr>
                        <td 
                            class="thumbcell"
                            ng-repeat="entry in feed.entries"
                            scroll-if="$index == current">
                            <img 
                                ng-src="{{entry.thumb_url}}"
                                ng-click="view($index)"
                                class="thumb {{get_filters($index, entry)}}" />
                            <div class="tag blue">{{entry.taken_ts}}</div>
                            <div class="tag black">{{get_access(entry)}}{{entry.user_id}}</div>
                            <div
                                class="tag"
                                style="background-color: {{tag_background_color(tag)}}; color: {{tag_foreground_color(tag)}};"
                                ng-repeat="tag in entry.tags">
                                {{tag}}
                            </div>
                        </td>
                    </tr>
                <table>
            </div>
            <!--<div id="entry_holder">
                <div 
                    class="entry {{get_filters($index, entry)}}"
                    style="background-image: url({{entry.thumb_url}})"
                    ng-click="view($index)"
                    ng-repeat="entry in feed.entries">    
                    <div class="tag blue">{{entry.taken_ts}}</div>
                    <div class="tag black">{{get_access(entry)}}{{entry.user_id}}</div>
                    <div
                        class="tag"
                        style="background-color: {{tag_background_color(tag)}}; color: {{tag_foreground_color(tag)}};"
                        ng-repeat="tag in entry.tags">
                        {{tag}}
                    </div>
                </div>
            </div>-->
        </div>
    </body>
</html>
